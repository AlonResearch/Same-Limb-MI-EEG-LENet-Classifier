Metadata-Version: 2.4
Name: mi3-eeg
Version: 1.0.0
Summary: MI3 EEG Motor Imagery Classification using Deep Learning
Author: MI3-EEG Team
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: torch>=2.0
Requires-Dist: numpy>=1.24
Requires-Dist: scipy>=1.11
Requires-Dist: scikit-learn>=1.3
Requires-Dist: matplotlib>=3.7
Requires-Dist: pandas>=2.0
Requires-Dist: ipykernel>=7.1.0
Provides-Extra: dev
Requires-Dist: mi3-eeg[test]; extra == "dev"
Requires-Dist: mi3-eeg[lint]; extra == "dev"
Provides-Extra: test
Requires-Dist: pytest>=8.0; extra == "test"
Requires-Dist: pytest-cov>=5.0; extra == "test"
Provides-Extra: lint
Requires-Dist: ruff>=0.4.0; extra == "lint"
Requires-Dist: mypy>=1.9; extra == "lint"
Provides-Extra: notebook
Requires-Dist: jupyterlab>=4.0; extra == "notebook"

# MI3 EEG Motor Imagery Classification

A modular, production-ready PyTorch package for classifying motor imagery EEG signals from the MI3 dataset using deep learning.

## ğŸ¯ Overview

Motor-imagery EEG trials from the MI3 dataset are classified with lightweight LENet variants:

- **LENet (CCB)** â€“ Convolutional Classification Block matching the MI2/BCI IV-2a architecture
- **LENet_FCL** â€“ Fully Connected Layer variant with dynamic sizing for higher-channel recordings

**Key Features:**
- âœ… Modular, testable architecture following best practices
- âœ… BIDS-compliant dataset structure
- âœ… Comprehensive logging and monitoring
- âœ… Automated training with early stopping
- âœ… Rich visualization suite
- âœ… 60+ unit tests ensuring reliability

## ğŸ“ Project Structure

```
MI-EEG-Final-ML-Proj/
â”œâ”€â”€ src/mi3_eeg/              # Main package
â”‚   â”œâ”€â”€ config.py             # Configuration and paths
â”‚   â”œâ”€â”€ logger.py             # Centralized logging
â”‚   â”œâ”€â”€ dataset.py            # Data loading and preprocessing
â”‚   â”œâ”€â”€ model.py              # Neural network architectures
â”‚   â”œâ”€â”€ train.py              # Training orchestration
â”‚   â”œâ”€â”€ evaluation.py         # Metrics and evaluation
â”‚   â”œâ”€â”€ visualization.py      # Plotting and visualization
â”‚   â””â”€â”€ main.py               # Pipeline orchestrator
â”œâ”€â”€ tests/                    # Unit tests (60+ tests)
â”œâ”€â”€ Datasets/                 # BIDS-formatted MI3 dataset
â”‚   â””â”€â”€ MI3/
â”‚       â”œâ”€â”€ sourcedata/       # Raw .cnt files (immutable)
â”‚       â”œâ”€â”€ derivatives/      # Preprocessed .mat files
â”‚       â””â”€â”€ code/             # MATLAB preprocessing scripts
â”œâ”€â”€ data/                     # PyTorch processing cache
â”‚   â”œâ”€â”€ tensors/              # Cached tensors
â”‚   â””â”€â”€ splits/               # Train/test splits
â”œâ”€â”€ models/                   # Saved model weights
â”œâ”€â”€ reports/                  # Training outputs
â”‚   â”œâ”€â”€ figures/              # Plots and visualizations
â”‚   â”œâ”€â”€ metrics/              # Evaluation results (JSON)
â”‚   â””â”€â”€ logs/                 # Training logs
â”œâ”€â”€ Notebooks/                # Exploratory notebooks
â””â”€â”€ pyproject.toml            # Project metadata & dependencies
```

## ğŸš€ Quick Start

### Installation

1. **Clone the repository:**
```bash
git clone <repository-url>
cd MI-EEG-Final-ML-Proj
```

2. **Install with pip:**
```bash
pip install -e .
```

Or with test dependencies:
```bash
pip install -e ".[test]"
```

3. **Verify installation:**
```bash
pytest tests/  # Run all tests
python -c "import mi3_eeg; print(mi3_eeg.__version__)"
```

### Running the Full Pipeline

Train both models with default settings:
```bash
python -m mi3_eeg.main
```

Train specific model with custom epochs:
```bash
python -m mi3_eeg.main --models lenet --epochs 500 --device cuda
```

### Using in Python

```python
from mi3_eeg import (
    load_dataset_from_config,
    prepare_data_loaders,
    create_model,
    train_model,
    evaluate_model,
)

# Load data
data_bundle = load_dataset_from_config()
train_loader, test_loader = prepare_data_loaders(data_bundle)

# Create and train model
model = create_model("lenet", device="cuda")
history = train_model(model, train_loader, test_loader)

# Evaluate
results = evaluate_model(model, test_loader)
print(f"Accuracy: {results.overall_accuracy * 100:.2f}%")
```

## ğŸ“Š Dataset

### MI3 Dataset Structure (BIDS Format)

The project expects BIDS-formatted MI3 data in `Datasets/MI3/`:

- **sourcedata/** â€“ Raw CNT acquisitions (immutable)
- **derivatives/** â€“ Preprocessed MATLAB .mat files
  - `sub-011_eeg90hz.mat` â€“ 90Hz downsampled, bandpass filtered (7-35Hz)
  - Shape: (965 samples, 62 channels, 360 timepoints)
  - Classes: Rest (0), Elbow (1), Hand (2)
- **code/** â€“ MATLAB preprocessing scripts (`MI3_process.m`)

### Data Processing Pipeline

1. Raw CNT files â†’ MATLAB preprocessing â†’ .mat files (derivatives)
2. Python loads from derivatives â†’ Class balancing â†’ PyTorch tensors
3. Train/test split (80/20) â†’ DataLoaders â†’ Model training

## ğŸ§ª Development

### Running Tests

```bash
# All tests
pytest

# Specific module
pytest tests/test_model.py -v

# With coverage
pytest --cov=mi3_eeg --cov-report=html
```

### Code Quality

```bash
# Format code (if ruff installed)
ruff format .

# Check linting
ruff check .

# Type checking (if mypy installed)
mypy src/
```

## ğŸ“ˆ Results

Typical performance on MI3 dataset (sub-011):

| Model      | Overall Acc | Rest Acc | Elbow Acc | Hand Acc |
|------------|-------------|----------|-----------|----------|
| LENet (CCB)| ~75-80%     | ~98%     | ~50-60%   | ~65-75%  |
| LENet_FCL  | ~70-75%     | ~98%     | ~60-70%   | ~35-45%  |

*Results vary based on random initialization and data splits.*

## ğŸ”§ Configuration

Key configurations in `src/mi3_eeg/config.py`:

### DataConfig
- `mat_filename`: Dataset file name
- `sampling_rate`: 90 Hz
- `bandpass_filter`: (7, 35) Hz
- `num_channels`: 62
- `test_size`: 0.2 (20% test split)

### TrainingConfig
- `epochs`: 1000 (with early stopping)
- `batch_size`: 64
- `learning_rate`: 0.01
- `dropout`: 0.35
- `early_stopping_patience`: 50

### ModelConfig
- `classes_num`: 3 (Rest, Elbow, Hand)
- `channel_count`: 62
- `drop_out`: 0.35

## ğŸ“š Module Documentation

### `config.py`
Configuration dataclasses for paths, data, training, and model parameters.

### `dataset.py`
- Load EEG data from BIDS derivatives
- Class balancing and preprocessing
- PyTorch DataLoader creation

### `model.py`
- LENet and LENet_FCL architectures
- Model factory functions
- Weight initialization and serialization

### `train.py`
- Training orchestration with early stopping
- Epoch-level train/validation loops
- Training history tracking

### `evaluation.py`
- Model evaluation and metrics
- Confusion matrix computation
- Per-class accuracy analysis

### `visualization.py`
- Training curve plots
- Confusion matrix visualizations
- Model comparison charts

### `main.py`
- End-to-end pipeline orchestrator
- CLI interface
- Logging and artifact management

## ğŸ“ Citation

If you use this code, please cite:

```bibtex
@software{mi3_eeg_2026,
  title = {MI3 EEG Motor Imagery Classification},
  author = {MI3-EEG Team},
  year = {2026},
  version = {1.0.0}
}
```

## ğŸ“„ License

[Specify your license here]

## ğŸš§ Future Improvements

- [ ] Additional model architectures (RNN, Transformer, Attention)
- [ ] Transfer learning capabilities
- [ ] Hyperparameter optimization with Optuna
- [ ] Cross-subject validation
- [ ] Real-time inference pipeline
- [ ] Web-based demo interface

## ğŸ¤ Contributing

Contributions are welcome! Please:
1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Ensure all tests pass (`pytest`)
5. Submit a pull request

## ğŸ“ Contact

For questions or issues, please open a GitHub issue or contact [your contact info].

---

**Built with â¤ï¸ for EEG research**
